#!/usr/bin/octave
# Created by Hershal Bhave on 2/16/13
# For M368K HW3, ยง 8.5 Number 7
# Written in GNU Octave
#
# Description: Verifying the miniproject data

data = [-3.142	0.06832
	-3.079	0.01777
	-3.016	-0.05477
	-2.953	0.02502
	-2.89	-0.1207
	-2.827	-0.1809
	-2.765	-0.1998
	-2.702	-0.3606
	-2.639	-0.4097
	-2.576	-0.4855
	-2.513	-0.5312
	-2.45	-0.7495
	-2.388	-0.7636
	-2.325	-0.6707
	-2.262	-0.7979
	-2.199	-0.7424
	-2.136	-0.7411
	-2.073	-0.8049
	-2.011	-0.7721
	-1.948	-0.7963
	-1.885	-0.7339
	-1.822	-0.5963
	-1.759	-0.4647
	-1.696	-0.3208
	-1.634	-0.3302
	-1.571	-0.1628
	-1.508	0.07076
	-1.445	0.09157
	-1.382	0.2684
	-1.319	0.3238
	-1.257	0.4527
	-1.194	0.4753
	-1.131	0.6081
	-1.068	0.5421
	-1.005	0.5119
	-0.9425	0.5
	-0.8796	0.5431
	-0.8168	0.5229
	-0.754	0.5067
	-0.6912	0.2878
	-0.6283	0.343
	-0.5655	0.2233
	-0.5027	0.16
	-0.4398	0.06335
	-0.377	-0.1138
	-0.3142	-0.02086
	-0.2513	-0.2439
	-0.1885	-0.2109
	-0.1257	-0.2254
	-0.06283  -0.3954
	0	-0.4238
	0.06283	 -0.2723
	0.1257	-0.3013
	0.1885	-0.2711
	0.2513	-0.2593
	0.3142	-0.2457
	0.377	-0.08467
	0.4398	-0.009232
	0.5027	0.09676
	0.5655	0.07933
	0.6283	0.1937
	0.6912	0.1985
	0.754	0.2164
	0.8168	0.2449
	0.8796	0.4075
	0.9425	0.3338
	1.005	0.4063
	1.068	0.3984
	1.131	0.3351
	1.194	0.3222
	1.257	0.2109
	1.319	0.1415
	1.382	0.01951
	1.445	-0.1317
	1.508	-0.2194
	1.571	-0.4258
	1.634	-0.5249
	1.696	-0.5939
	1.759	-0.7906
	1.822	-0.8522
	1.885	-0.8046
	1.948	-1.021
	2.011	-1.048
	2.073	-1.128
	2.136	-1.106
	2.199	-1.066
	2.262	-1.102
	2.325	-1.036
	2.388	-1.023
	2.45	-0.8649
	2.513	-0.7706
	2.576	-0.6505
	2.639	-0.516
	2.702	-0.5012
	2.765	-0.4192
	2.827	-0.3945
	2.89	-0.2484
	2.953	-0.08365
	3.016	-0.1774
	3.079	-0.1283];

x=data(:,1);
y=data(:,2);
m=50;
n=5;

A=zeros(n+1,1)
B=zeros(n+1,1)

for k=0:n
  A(k+1) = 1/m*(sum(y(:).*cos(k*x(:))));
  B(k+1) = 1/m*(sum(y(:).*sin(k*x(:))));
endfor
B(1)=0; B(n+1)=0;
A
B

s=A(1)./2 + A(n+1).*cos(n.*x);
for i=1:n-1
  s+= A(i+1).*cos(i.*x) + B(i+1).*sin(i.*x);
endfor

figure;
hold on;
plot(x,y, 'b');
plot(x,s, 'k');
hold off;

E = sum((y-s).^2)

legend("Original Function","Discrete Trig Poly Approx","location","northwest");
title("HW4 MiniProject: y vs x of y and its Discrete Least-Squares Trig Poly Approximation")
xlabel("x");
ylabel("y");
