\documentclass[a4paper,12pt]{article}
\title{M368K Homework 8}
\author{Hershal Bhave}
\date{\today}

\usepackage{listings}
\usepackage{mathtools}
\usepackage{fullpage}
\usepackage{color}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\footnotesize\ttfamily,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  frame=single,                    % adds a frame around the code
  keywordstyle=\color{blue},       % keyword style
  % language=Octave,                 % the language of the code
  % numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  % numbersep=5pt,                   % how far the line-numbers are from the code
  % numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  % stepnumber=2,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=2,                       % sets default tabsize to 2 spaces
  title=\lstname,                  % show the filename of files included with \lstinputlisting; also try caption instead of title
  columns=fullflexible,
}

\begin{document}
\maketitle 

\section{2b$^{1}$}
Use Broyden's method with $\mathbf{x^{(0)}}$ = $\mathbf{0}$ to compute
$\mathbf{x^{(2)}}$ for the following nonlinear system, given
$\mathbf{x^{(0)}}$=
$\begin{pmatrix}
  5\\
  2\\
  0\\
\end{pmatrix}$

\begin{align}
  \label{eq:2b}
  x^2_1+x_2-37&=0\\
  x_1-x^2_2-5&=0\\
  x_1+x_2+x_3-3&=0
\end{align}

Using the algorithm specified in \texttt{broyden.m}, I achieved the
following:\\

\setlength{\tabcolsep}{2em}
\begin{center}
  \begin{tabular}[c]{lllll}
    \hline
    $k$ & $x^{(k)}_1$  & $x^{(k)}_2$ & $x^{(k)}_3$ & $\|\mathbf{x}^{(k)}-\mathbf{x}^{(k-1)}\|_2$ \\
    \hline
    0 & 5 & 2 & 0 &  \\
    1 & 6.0732 & 1.2683 & -4.3415 & 4.5316 \\
    2 & 5.9790 & 1.1178 & -4.0967 & 0.30241 \\
    3 & 6.0040 & 1.0413 & -4.0453 & 0.095495 \\
    $\vdots$ &$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ \\
    $\infty$ & 6 & 1 & -4 & $\lim_{k \to \infty}\textnormal{Error}=0$ \\
    \hline
  \end{tabular}
\end{center}

\begin{minipage}{1.0\linewidth}
  \lstinputlisting[language=Octave]{broyden.m}
\end{minipage}

\newpage
\section{10b}
By multiplying on the right by $A + \mathbf{x y^{t}}$, show that when
$\mathbf{y^{t}} A^{-1} \mathbf{x} \ne -1$ we have
\begin{equation}
  \label{eq:10b}
  (A+\mathbf{x y^{t}})^{-1} = A^{-1} - \frac{A^{-1} \mathbf{x y^{t}} A^{-1}}{1+\mathbf{y^{t}}A^{-1}\mathbf{x}}
\end{equation}



\end{document}